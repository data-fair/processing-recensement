{
    "type": "object",
    "x-display": "tabs",
    "required": ["datasetMode"],
    "allOf": [{
      "title": "Jeu de données",
      "oneOf": [{
        "title": "Créer un jeu de données",
        "required": ["dataset"],
        "properties": {
          "datasetMode": { "type": "string", "const": "create", "title": "Action" },
          "dataset": {
            "type": "object",
            "properties": {
              "title": {"type": "string", "title": "Titre (laissez vide pour utiliser le nom de fichier téléchargé)"}
            }
          }
        }
      }, {
        "title": "Mettre à jour un jeu de données (fichier)",
        "required": ["dataset"],
        "properties": {
          "datasetMode": { "type": "string", "const": "update" },
          "dataset": {
            "type": "object",
            "title": "Jeu de donnée existant",
            "x-fromUrl": "{context.dataFairUrl}/api/v1/datasets?q={q}&select=id,title&{context.ownerFilter}",
            "x-itemsProp": "results",
            "x-itemTitle": "title",
            "x-itemKey": "id",
            "properties": {
              "id": {"type": "string", "title": "Identifiant"},
              "title": {"type": "string", "title": "Titre"}
            }
          }, 
          "forceUpdate": {
              "title": "Forcer la mise à jour",
              "description": "La mise à jour forcée permet de remettre à jour le schéma en cas de modification sur le jeu de donnée",
              "type": "boolean",
              "default": false
          }
        }
      }]
    }, {
        "title": "Paramètres",
        "properties": {
            "filter":{
                "type": "string",
                "title": "Département à utiliser",
                "description": "Le département doit être au format 2 chiffres (ex: 56, 01) ou 3 chiffres pour les DROM-COM (ex: 974)"
            },
            "year":{
                "type": "string",
                "title": "Année(s) à traiter",
                "description": "L'année doit être au format 4 chiffres (ex: 2019) si plusieurs années, séparez les par un '-' (ex: 2018-2029), si aucune année n'est précisée, toutes les années disponibles seront traitées"
            },
            "datasetRP":{
              "type": "string",
              "title": "Jeu de données de recensement",
              "description": "Ce jeu de données permet pour les années non renseignés dans le pluggin  (année > 2019) de récupérer les données de recensement de ces années. Peut comme pour les années être séparé par un - pour contenir plusieurs jeux, cette information est récupérable dans la documentation de l'api (https://api.insee.fr/catalogue/site/themes/wso2/subthemes/insee/pages/item-info.jag?name=DonneesLocales&version=V0.1&provider=insee#!/default/getDonnees) dans le fichier Documentation RP"
          },
            "apiKey":{
              "type": "string",
              "title": "Clé d'API insee",
              "description": "Clé de l'API Métadonnées api.insee.fr/catalogue (Clef du consommateur + ':' + Secret du consommateur)"
            },
            "clearFiles": {
              "title": "supprimer les fichiers téléchargés",
              "type": "boolean",
              "default": true
            }
        }
    }]
}